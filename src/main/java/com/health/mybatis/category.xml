<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.health.mybatis">

	<select id="getAllSymptom" resultType="SymptomDto">
		select * from symptom
	</select>

	<select id="getAllMaterial" resultType="MaterialDto">
		select * from material
	</select>
	
	<select id="seqPostNextVal" resultType="int">
		select seq_post.nextval from dual
	</select>
	
	<select id="getsymptName" resultType="string" parameterType = "int">
		select symptomname from symptom WHERE sympno = ${sympNo}
	</select>

	<insert id="insertPost" parameterType="PostDto">
		insert into post
		values(#{postNo}, #{enterpriseNo}, #{title}, #{content}, #{postImg}, sysdate, null)
	</insert>

	<insert id="insertSymptomPost" parameterType="SymptomPostDto">
		insert into symptompost
		values(seq_symptomPost.nextval, #{postNo}, #{sympNo})
	</insert>

	<insert id="insertMaterialPost" parameterType="MaterialPostDto">
		insert into materialpost
		values(seq_materialPost.nextval, #{materialNo}, #{postNo})
	</insert>




	
	<select id="getPostForSympno" resultType="PostDto" parameterType = "HashMap">
		SELECT * FROM post 
		WHERE postno in ( SELECT postno FROM symptompost 
		WHERE sympno = CAST(#{sympNo} as number))
	</select>
	
	<select id="getPostForKeyword" resultType="PostDto" parameterType = "HashMap">
		SELECT * FROM post WHERE title LIKE '%'||#{keyword}||'%'
	</select>

	<select id="getPostForAll" resultType="PostDto" parameterType = "HashMap">
		select * from post
	</select>



</mapper>